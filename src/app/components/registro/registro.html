<!-- HTML Template -->
<div class="register-container">
  <div class="register-card">
    <div class="register-header">
      <h1>Crear cuenta</h1>
      <p>Regístrate para comenzar</p>
    </div>
    
    <form class="register-form" [formGroup]="form" (ngSubmit)="registrarse()">
      <div class="form-group">
        <label for="firstName">Nombres</label>
        <input 
          formControlName="nombres"
          placeholder="Ej: Juan Fernando"
        />
        @if (form.controls.nombres.invalid && form.controls.nombres.dirty && form.controls.nombres.touched) {
          <div class="error-msg">
            El nombre es requerido.
          </div>
        }
        @if ((form.controls.nombres.value?.length ?? 0) < 3 && form.controls.nombres.touched && form.controls.nombres.dirty) {
          <div class="error-msg">
            Deben de ser mínimo 3 caracteres.
          </div>
        }
      </div>

      <div class="form-group">
        <label for="lastName">Apellidos</label>
        <input 
          formControlName="apellidos"
          placeholder="Ej: Ramirez Villarreal"
        />
        @if (form.controls.apellidos.invalid && form.controls.apellidos.dirty && form.controls.apellidos.touched) {
          <div class="error-msg">
            Los apellidos son requeridos.
          </div>
        }
        @if ((form.controls.apellidos.value?.length ?? 0) < 3 && form.controls.apellidos.touched && form.controls.apellidos.dirty) {
          <div class="error-msg">
            Deben de ser mínimo 3 caracteres.
          </div>
        }
      </div>

      <div class="form-group">
        <label for="username">Nombre de usuario</label>
        <input 
          placeholder="Usuario"
          formControlName="usuario"
        />
        @if (form.controls.usuario.invalid && form.controls.usuario.dirty && form.controls.usuario.touched) {
          <div class="error-msg">
            El usuario es requerido.
          </div>
        }
        @if ((form.controls.usuario.value?.length ?? 0) < 3 && form.controls.usuario.touched && form.controls.usuario.dirty) {
          <div class="error-msg">
            Deben de ser mínimo 3 caracteres.
          </div>
        }
      </div>
      
      <div class="form-group">
        <label for="email">Correo electrónico</label>
        <input 
          type="email"
          placeholder="tu@email.com"
          formControlName="correo"
        />
        @if (form.controls.correo.invalid && form.controls.correo.dirty && form.controls.correo.touched) {
          <div class="error-msg">
            El correo es requerido y debe ser válido.
          </div>
        }
      </div>
      
      <div class="form-group">
        <label for="password">Contraseña</label>
        <input 
          type="password"
          placeholder="••••••••"
          formControlName="contrasena"
        />
        @if (form.controls.contrasena.invalid && form.controls.contrasena.dirty && form.controls.contrasena.touched) {
          <div class="error-msg">
            La contraseña es requerida.
          </div>
        }
        @if ((form.controls.contrasena.value?.length ?? 0) < 8 && form.controls.contrasena.touched && form.controls.contrasena.dirty) {
          <div class="error-msg">
            Deben de ser mínimo 8 caracteres.
          </div>
        }
      </div>

      <!-- Sección de Domicilio -->
      <div class="address-section">
        <h3 style="margin-bottom: 10px;">Domicilio</h3>
        
        <div class="form-row">
          <div class="form-group half">
            <label for="numeroCalle">Número</label>
            <input 
              type="number"
              placeholder="123"
              formControlName="numeroCalle"
            />
            @if (form.controls.numeroCalle.invalid && form.controls.numeroCalle.dirty && form.controls.numeroCalle.touched) {
              <div class="error-msg">
                El número es requerido.
              </div>
            }
          </div>

          <div class="form-group half">
            <label for="calle">Calle</label>
            <input 
              placeholder="Nombre de la calle"
              formControlName="calle"
            />
            @if (form.controls.calle.invalid && form.controls.calle.dirty && form.controls.calle.touched) {
              <div class="error-msg">
                La calle es requerida.
              </div>
            }
          </div>
        </div>

        <div class="form-row">
          <div class="form-group half">
            <label for="ciudad">Ciudad</label>
            <input 
              placeholder="Ciudad"
              formControlName="ciudad"
            />
            @if (form.controls.ciudad.invalid && form.controls.ciudad.dirty && form.controls.ciudad.touched) {
              <div class="error-msg">
                La ciudad es requerida.
              </div>
            }
          </div>

          <div class="form-group half">
            <label for="estado">Estado</label>
            <select formControlName="estado">
              <option value="" disabled selected>Selecciona un estado</option>
              @for (estado of estados; track $index) {
                <option [value]="estado.code">{{ estado.state }}</option>
              }
            </select>
            @if (form.controls.estado.invalid && form.controls.estado.dirty && form.controls.estado.touched) {
              <div class="error-msg">
                El estado es requerido.
              </div>
            }
          </div>
        </div>

        <div class="form-group">
          <label for="zip">Código Postal</label>
          <input 
            type="number"
            placeholder="12345"
            maxlength="5"
            formControlName="zip"
          />
          @if (form.controls.zip.invalid && form.controls.zip.dirty && form.controls.zip.touched) {
            <div class="error-msg">
              El código postal debe tener 5 dígitos.
            </div>
          }
        </div>
      </div>
      
      <button type="submit" class="btn-register">Crear cuenta</button>
      
      <div class="login-link">
        ¿Ya tienes cuenta? <a [routerLink]="'/iniciar-sesion'">Inicia sesión</a>
      </div>
      <div class="login-link">
        Volver al <a [routerLink]="'/'">Inicio</a>
      </div>
    </form>
  </div>
</div>

<p-toast position="bottom-right" key="br" />